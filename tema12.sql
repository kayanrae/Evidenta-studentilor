
CREATE TABLE STUDENTI (
    NR_LEGITIMATIE INT PRIMARY KEY,
    NUME VARCHAR(50),
    PRENUME VARCHAR(50),
    SECTIE VARCHAR(50),
    AN INT,
    SEX CHAR(1)
);

CREATE TABLE DISCIPLINA (
    COD_DEN VARCHAR(10) PRIMARY KEY,
    ORE_CURS INT,
    ORE_SEMINAR INT,
    ORE_LABORATOR INT,
    NR_CREDITE INT
);

CREATE TABLE CATALOG (
    NR_LEGITIMATIE INT,
    COD_DEN VARCHAR(10),
    DATA DATE,
    NOTA INT,
    PRIMARY KEY (NR_LEGITIMATIE, COD_DEN),
    FOREIGN KEY (NR_LEGITIMATIE) REFERENCES STUDENTI(NR_LEGITIMATIE),
    FOREIGN KEY (COD_DEN) REFERENCES DISCIPLINA(COD_DEN)
);

CREATE TABLE PROFESORI (
    CNP CHAR(13) PRIMARY KEY,
    NUME_PROFESOR VARCHAR(50),
    PRENUME_PROFESOR VARCHAR(50),
    TITLU VARCHAR(50),
    ADRESA VARCHAR(100),
    TELEFON VARCHAR(20)
);

CREATE TABLE PREDARE (
    CNP_PROFESOR CHAR(13),
    COD_DEN VARCHAR(10),
    C INT,
    S INT,
    L INT,
    PRIMARY KEY (CNP_PROFESOR, COD_DEN),
    FOREIGN KEY (CNP_PROFESOR) REFERENCES PROFESORI(CNP),
    FOREIGN KEY (COD_DEN) REFERENCES DISCIPLINA(COD_DEN)
);

INSERT INTO STUDENTI VALUES (1, 'Popescu', 'Ion', 'Informatica', 3, 'M');
INSERT INTO STUDENTI VALUES (2, 'Ionescu', 'Maria', 'Informatica', 3, 'F');
INSERT INTO STUDENTI VALUES (3, 'Radu', 'Alexandru', 'Informatica', 3, 'M');
INSERT INTO STUDENTI VALUES (4, 'Stanescu', 'Elena', 'Informatica', 3, 'F');
INSERT INTO STUDENTI VALUES (5, 'Dumitru', 'Ion', 'Informatica', 3, 'M');
INSERT INTO STUDENTI VALUES (6, 'Stoica', 'Ana', 'Informatica', 3, 'F');
INSERT INTO STUDENTI VALUES (7, 'Petrescu', 'Gabriel', 'Informatica', 3, 'M');
INSERT INTO STUDENTI VALUES (8, 'Vasilescu', 'Sofia', 'Informatica', 3, 'F');
INSERT INTO STUDENTI VALUES (9, 'Andreescu', 'Matei', 'Informatica', 3, 'M');
INSERT INTO STUDENTI VALUES (10, 'Mihai', 'Ioana', 'Informatica', 3, 'F');

INSERT INTO DISCIPLINA VALUES ('C101', 2, 0, 2, 25);
INSERT INTO DISCIPLINA VALUES ('ALGB101', 2, 2, 0, 25);
INSERT INTO DISCIPLINA VALUES ('C++101', 2, 0, 2, 25);
INSERT INTO DISCIPLINA VALUES ('SSI101', 2, 0, 2, 25);
INSERT INTO DISCIPLINA VALUES ('POO101', 2, 0, 2, 25);
INSERT INTO DISCIPLINA VALUES ('ENG111', 2, 2, 0, 25);
INSERT INTO DISCIPLINA VALUES ('ENG121', 2, 2, 0, 25);
INSERT INTO DISCIPLINA VALUES ('PYTHON201', 2, 0, 2, 25);
INSERT INTO DISCIPLINA VALUES ('STATS201', 2, 0, 2, 25);

INSERT INTO CATALOG VALUES (1, 'C101', '01-DEC-21', 9);
INSERT INTO CATALOG VALUES (1, 'ALGB101', '01-DEC-21', 7);
INSERT INTO CATALOG VALUES (1, 'C++101', '01-DEC-21', 4);
INSERT INTO CATALOG VALUES (1, 'SSI101', '01-DEC-22', 7);
INSERT INTO CATALOG VALUES (1, 'POO101', '01-DEC-22', 6);
INSERT INTO CATALOG VALUES (1, 'ENG111', '01-DEC-22', 10);
INSERT INTO CATALOG VALUES (1, 'ENG121', '01-DEC-23', 10);
INSERT INTO CATALOG VALUES (1, 'PYTHON201', '01-DEC-23', 9);
INSERT INTO CATALOG VALUES (1, 'STATS201', '01-DEC-23', 9);
INSERT INTO CATALOG VALUES (2, 'C101', '01-DEC-21', 7);
INSERT INTO CATALOG VALUES (2, 'ALGB101', '01-DEC-21', 5);
INSERT INTO CATALOG VALUES (2, 'C++101', '01-DEC-21', 9);
INSERT INTO CATALOG VALUES (2, 'SSI101', '01-DEC-22', 3);
INSERT INTO CATALOG VALUES (2, 'POO101', '01-DEC-22', 8);
INSERT INTO CATALOG VALUES (2, 'ENG111', '01-DEC-22', 9);
INSERT INTO CATALOG VALUES (2, 'ENG121', '01-DEC-23', 7);
INSERT INTO CATALOG VALUES (2, 'PYTHON201', '01-DEC-23', 9);
INSERT INTO CATALOG VALUES (2, 'STATS201', '01-DEC-23', 9);
INSERT INTO CATALOG VALUES (3, 'C101', '01-DEC-21', 2);
INSERT INTO CATALOG VALUES (3, 'ALGB101', '01-DEC-21', 7);
INSERT INTO CATALOG VALUES (3, 'C++101', '01-DEC-21', 5);
INSERT INTO CATALOG VALUES (3, 'SSI101', '01-DEC-22', 6);
INSERT INTO CATALOG VALUES (3, 'POO101', '01-DEC-22', 6);
INSERT INTO CATALOG VALUES (3, 'ENG111', '01-DEC-22', 10);
INSERT INTO CATALOG VALUES (3, 'ENG121', '01-DEC-23', 10);
INSERT INTO CATALOG VALUES (3, 'PYTHON201', '01-DEC-23', 9);
INSERT INTO CATALOG VALUES (3, 'STATS201', '01-DEC-23', 9);
INSERT INTO CATALOG VALUES (4, 'C101', '01-DEC-21', 7);
INSERT INTO CATALOG VALUES (4, 'ALGB101', '01-DEC-21', 9);
INSERT INTO CATALOG VALUES (4, 'C++101', '01-DEC-21', 4);
INSERT INTO CATALOG VALUES (4, 'SSI101', '01-DEC-22', 6);
INSERT INTO CATALOG VALUES (4, 'POO101', '01-DEC-22', 10);
INSERT INTO CATALOG VALUES (4, 'ENG111', '01-DEC-22', 10);
INSERT INTO CATALOG VALUES (4, 'ENG121', '01-DEC-23', 9);
INSERT INTO CATALOG VALUES (4, 'PYTHON201', '01-DEC-23', 9);
INSERT INTO CATALOG VALUES (4, 'STATS201', '01-DEC-23', 5);
INSERT INTO CATALOG VALUES (5, 'C101', '01-DEC-21', 7);
INSERT INTO CATALOG VALUES (5, 'ALGB101', '01-DEC-21', 9);
INSERT INTO CATALOG VALUES (5, 'C++101', '01-DEC-21', 3);
INSERT INTO CATALOG VALUES (5, 'SSI101', '01-DEC-22', 8);
INSERT INTO CATALOG VALUES (5, 'POO101', '01-DEC-22', 5);
INSERT INTO CATALOG VALUES (5, 'ENG111', '01-DEC-22', 10);
INSERT INTO CATALOG VALUES (5, 'ENG121', '01-DEC-23', 9);
INSERT INTO CATALOG VALUES (5, 'PYTHON201', '01-DEC-23', 10);
INSERT INTO CATALOG VALUES (5, 'STATS201', '01-DEC-23', 10);
INSERT INTO CATALOG VALUES (6, 'C101', '01-DEC-21', 9);
INSERT INTO CATALOG VALUES (6, 'ALGB101', '01-DEC-21', 4);
INSERT INTO CATALOG VALUES (6, 'C++101', '01-DEC-21', 2);
INSERT INTO CATALOG VALUES (6, 'SSI101', '01-DEC-22', 8);
INSERT INTO CATALOG VALUES (6, 'POO101', '01-DEC-22', 3);
INSERT INTO CATALOG VALUES (6, 'ENG111', '01-DEC-22', 3);
INSERT INTO CATALOG VALUES (6, 'ENG121', '01-DEC-23', 5);
INSERT INTO CATALOG VALUES (6, 'PYTHON201', '01-DEC-23', 5);
INSERT INTO CATALOG VALUES (6, 'STATS201', '01-DEC-23', 5);
INSERT INTO CATALOG VALUES (7, 'C101', '01-DEC-21', 5);
INSERT INTO CATALOG VALUES (7, 'ALGB101', '01-DEC-21', 9);
INSERT INTO CATALOG VALUES (7, 'C++101', '01-DEC-21', 6);
INSERT INTO CATALOG VALUES (7, 'SSI101', '01-DEC-22', 7);
INSERT INTO CATALOG VALUES (7, 'POO101', '01-DEC-22', 5);
INSERT INTO CATALOG VALUES (7, 'ENG111', '01-DEC-22', 8);
INSERT INTO CATALOG VALUES (7, 'ENG121', '01-DEC-23', 7);
INSERT INTO CATALOG VALUES (7, 'PYTHON201', '01-DEC-23', 5);
INSERT INTO CATALOG VALUES (7, 'STATS201', '01-DEC-23', 7);
INSERT INTO CATALOG VALUES (8, 'C101', '01-DEC-21', 8);
INSERT INTO CATALOG VALUES (8, 'ALGB101', '01-DEC-21', 5);
INSERT INTO CATALOG VALUES (8, 'C++101', '01-DEC-21', 9);
INSERT INTO CATALOG VALUES (8, 'SSI101', '01-DEC-21', 5);
INSERT INTO CATALOG VALUES (8, 'POO101', '01-DEC-22', 7);
INSERT INTO CATALOG VALUES (8, 'ENG111', '01-DEC-22', 5);
INSERT INTO CATALOG VALUES (8, 'ENG121', '01-DEC-22', 6);
INSERT INTO CATALOG VALUES (8, 'PYTHON201', '01-DEC-23', 9);
INSERT INTO CATALOG VALUES (8, 'STATS201', '01-DEC-23', 8);
INSERT INTO CATALOG VALUES (9, 'C101', '01-DEC-21', 5);
INSERT INTO CATALOG VALUES (9, 'ALGB101', '01-DEC-21', 7);
INSERT INTO CATALOG VALUES (9, 'C++101', '01-DEC-21', 9);
INSERT INTO CATALOG VALUES (9, 'SSI101', '01-DEC-22', 5);
INSERT INTO CATALOG VALUES (9, 'POO101', '01-DEC-22', 6);
INSERT INTO CATALOG VALUES (9, 'ENG111', '01-DEC-22', 8);
INSERT INTO CATALOG VALUES (9, 'ENG121', '01-DEC-23', 7);
INSERT INTO CATALOG VALUES (9, 'PYTHON201', '01-DEC-23', 5);
INSERT INTO CATALOG VALUES (9, 'STATS201', '01-DEC-23', 7);
INSERT INTO CATALOG VALUES (10, 'C101', '01-DEC-21', 8);
INSERT INTO CATALOG VALUES (10, 'ALGB101', '01-DEC-21', 5);
INSERT INTO CATALOG VALUES (10, 'C++101', '01-DEC-21', 7);
INSERT INTO CATALOG VALUES (10, 'SSI101', '01-DEC-22', 8);
INSERT INTO CATALOG VALUES (10, 'POO101', '01-DEC-22', 5);
INSERT INTO CATALOG VALUES (10, 'ENG111', '01-DEC-22', 6);
INSERT INTO CATALOG VALUES (10, 'ENG121', '01-DEC-23', 8);
INSERT INTO CATALOG VALUES (10, 'PYTHON201', '01-DEC-23', 5);
INSERT INTO CATALOG VALUES (10, 'STATS201', '01-DEC-23', 7);

INSERT INTO PROFESORI VALUES ('2950228035099', 'Ioanescu', 'Maria', 'Profesor', 'Str. Mihai Eminescu, Nr. 10, Craiova', '021-123-4567');
INSERT INTO PROFESORI VALUES ('1800617035223', 'Popa', 'Andrei', 'Profesor Asociat', 'Str. Alexandru Ioan Cuza, Nr. 15, Craiova', '031-234-5678');
INSERT INTO PROFESORI VALUES ('1980523035176', 'Dumitrache', 'Ionut', 'Conferen?iar', 'Bd. 1 Decembrie 1918, Nr. 20, Craiova', '0232-345-6789');
INSERT INTO PROFESORI VALUES ('2961116035321', 'Georgescu', 'Gabriela', 'Lector', 'Str. Avram Iancu, Nr. 30, Craiova', '0256-456-7890');
INSERT INTO PROFESORI VALUES ('5678901234567', 'Vladescu', 'Florin', 'Asistent', 'Calea Victoriei, Nr. 25, Craiova', '0268-567-8901');
INSERT INTO PROFESORI VALUES ('2900315035162', 'Constantinescu', 'Elena', 'Profesor', 'Bd. Carol I, Nr. 5, Craiova', '0333-678-9012');
INSERT INTO PROFESORI VALUES ('1900415035218', 'Marinescu', 'Stefan', 'Conferen?iar', 'Str. Vasile Alecsandri, Nr. 12, Craiova', '0351-789-0123');
INSERT INTO PROFESORI VALUES ('2870406035077', 'Nistor', 'Alina', 'Lector', 'Bd. ?tefan cel Mare, Nr. 8, Craiova', '0244-890-1234');
INSERT INTO PROFESORI VALUES ('1850621035088', 'Popovici', 'Mihai', 'Asistent', 'Str. Traian, Nr. 18, Craiova', '0341-901-2345');

INSERT INTO PREDARE VALUES ('2950228035099', 'C101', 2, 0, 2);
INSERT INTO PREDARE VALUES ('1800617035223', 'ALGB101', 2, 2, 0);
INSERT INTO PREDARE VALUES ('1980523035176', 'C++101', 2, 0, 2);
INSERT INTO PREDARE VALUES ('2961116035321', 'SSI101', 2, 0, 2);
INSERT INTO PREDARE VALUES ('5678901234567', 'POO101', 2, 0, 2);
INSERT INTO PREDARE VALUES ('2900315035162', 'ENG111', 2, 2, 0);
INSERT INTO PREDARE VALUES ('1900415035218', 'ENG121', 2, 2, 0);
INSERT INTO PREDARE VALUES ('2870406035077', 'PYTHON201', 2, 0, 2);
INSERT INTO PREDARE VALUES ('1850621035088', 'STATS201', 2, 0, 2);

SELECT NR_LEGITIMATIE, COUNT(*) AS NUMAR_PREZENTE
FROM CATALOG
GROUP BY NR_LEGITIMATIE, COD_DEN
HAVING COUNT(*) > 2;

SELECT s.NR_LEGITIMATIE, s.AN, AVG(c.NOTA) AS MEDIA
FROM CATALOG c
JOIN STUDENTI s ON c.NR_LEGITIMATIE = s.NR_LEGITIMATIE
GROUP BY s.NR_LEGITIMATIE, s.AN
HAVING AVG(c.NOTA) > 8;

SELECT NR_LEGITIMATIE, SUM(NR_CREDITE) AS SUMA_CREDITE
FROM CATALOG
JOIN DISCIPLINA ON CATALOG.COD_DEN = DISCIPLINA.COD_DEN
GROUP BY NR_LEGITIMATIE
HAVING SUM(NR_CREDITE) < 213;

SELECT COD_DEN, NUMAR_RESTANTIERI
FROM (
    SELECT COD_DEN, COUNT(*) AS NUMAR_RESTANTIERI
    FROM CATALOG
    WHERE NOTA < 5
    GROUP BY COD_DEN
    ORDER BY NUMAR_RESTANTIERI DESC
)
WHERE ROWNUM <= 10;




